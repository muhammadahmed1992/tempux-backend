generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL_DEV_USERS")
}

model RoleAccessManagement {
  id                BigInt    @id @default(autoincrement())
  role_id           BigInt    @db.BigInt
  access_management_id BigInt @db.BigInt
  description       String?   @db.VarChar(200)
  created_at        DateTime  @default(now()) @db.Timestamptz(6)
  updated_at        DateTime  @default(now()) @db.Timestamptz(6)
  is_deleted        Boolean   @default(false)

  role              Roles     @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  access_management AccessManagement @relation(fields: [access_management_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([role_id, access_management_id])
  @@map("role_access_management")
}

model AccessManagement {
  id           BigInt    @id @default(autoincrement())
  access       String    @db.VarChar(50)
  description  String?   @db.VarChar(200)
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @db.Timestamptz(6)
  is_deleted   Boolean   @default(false)

  role_access_management RoleAccessManagement[]

  @@map("access_management")
}

model SavedSearch {
  id           BigInt    @id @default(autoincrement())
  user_id      BigInt     @db.BigInt
  search_query Json
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  is_deleted   Boolean   @default(false)
  user         User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("saved_searches")
}

model SellerProfileDetail {
  id                BigInt    @id @default(autoincrement())
  brand_name        String    @db.VarChar(50)
  brand_description String?   @db.VarChar(100)
  user_id           BigInt    @db.BigInt
  vat_number        String?   @db.VarChar(15)
  location_from     String?   @db.VarChar(1000)
  is_private        Boolean   @default(true)
  created_at        DateTime  @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @db.Timestamptz(6)
  is_deleted        Boolean   @default(false)
  user              User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("seller_profile_detail")
}

model SellerProfileRating {
  id               BigInt   @id @default(autoincrement())
  rating_name      String   @db.VarChar(50)
  rating_value     Decimal? @db.Decimal(2, 1)
  seller_id        BigInt?  @db.BigInt
  reviewed_by      BigInt?  @db.BigInt
  created_at       DateTime  @default(now()) @db.Timestamptz(6)
  updated_at       DateTime? @db.Timestamptz(6)
  is_deleted       Boolean   @default(false)
  reviewedByUser   User?     @relation("seller_profile_rating_reviewed_byTousers", fields: [reviewed_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
  sellerUser       User?     @relation("seller_profile_rating_seller_idTousers", fields: [seller_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("seller_profile_rating")
}

model Roles {
  id             BigInt    @id @default(autoincrement())
  name           String    @unique @db.VarChar(20)
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime  @default(now()) @db.Timestamptz(6)
  is_deleted     Boolean   @default(false)

  user_roles     UserRoles[]
  role_access_management RoleAccessManagement[]

  @@map("roles")
}

model UserRoles {
  id           BigInt    @id @default(autoincrement())
  user_id      BigInt     @db.BigInt
  role_id      BigInt    @db.BigInt
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @db.Timestamptz(6)
  is_deleted   Boolean   @default(false)

  user         User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  role         Roles     @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([user_id, role_id])
  @@map("user_roles")
}

model User {
  id           BigInt     @id @default(autoincrement())
  name         String     @db.VarChar(100)
  email        String     @db.VarChar(150) @unique
  full_name    String?    @db.VarChar(100)
  password     String     @db.VarChar(150)
  telephone    String?    @db.VarChar(15)
  address      String?    @db.VarChar(150)
  created_at   DateTime   @default(now()) @db.Timestamptz(6)
  updated_at   DateTime   @default(now()) @db.Timestamptz(6)
  is_deleted   Boolean    @default(false)
  otp          String?    @db.Char(60)
  otp_expires_at DateTime?  @db.Timestamptz(6)
  otp_verified Boolean    @default(false)

  googleId     String?    @db.VarChar(400)
  facebookId   String?    @db.VarChar(400)
  onboarded    Boolean    @default(false)
  is_seller_approved  Boolean   @default(false)

  saved_searches        SavedSearch[]
  seller_profile_detail SellerProfileDetail[]
  reviewedRatings       SellerProfileRating[] @relation("seller_profile_rating_reviewed_byTousers")
  sellerRatings         SellerProfileRating[] @relation("seller_profile_rating_seller_idTousers")
  user_roles            UserRoles[]

  @@map("users")
}
